<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 PK | R로 하는 약동학, 약력학 모델링</title>
  <meta name="description" content="1 PK | R로 하는 약동학, 약력학 모델링" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="1 PK | R로 하는 약동학, 약력학 모델링" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://study-pkpd.netlify.com/" />
  
  
  <meta name="github-repo" content="shanmdphd/wnl" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 PK | R로 하는 약동학, 약력학 모델링" />
  
  
  

<meta name="author" content="한성필, 배균섭" />


<meta name="date" content="2019-11-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">PKPD by R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="pk.html"><a href="pk.html"><i class="fa fa-check"></i><b>1</b> PK</a><ul>
<li class="chapter" data-level="1.1" data-path="pk.html"><a href="pk.html#pk1"><i class="fa fa-check"></i><b>1.1</b> PK1</a></li>
<li class="chapter" data-level="1.2" data-path="pk.html"><a href="pk.html#pk2"><i class="fa fa-check"></i><b>1.2</b> PK2</a></li>
<li class="chapter" data-level="1.3" data-path="pk.html"><a href="pk.html#pk3"><i class="fa fa-check"></i><b>1.3</b> PK3</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R로 하는 약동학, 약력학 모델링</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pk" class="section level1">
<h1><span class="header-section-number">1</span> PK</h1>
<p><code>wnl</code> 라이브러리를 불러오고 자료를 읽어옵니다.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="pk.html#cb1-1"></a><span class="kw">library</span>(wnl)</span></code></pre></div>
<pre><code>## Loading required package: numDeriv</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="pk.html#cb3-1"></a>dPK02 =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/PK02.csv&quot;</span>, <span class="dt">skip=</span><span class="dv">1</span>)</span>
<span id="cb3-2"><a href="pk.html#cb3-2"></a><span class="kw">colnames</span>(dPK02) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TIME&quot;</span>, <span class="st">&quot;DV&quot;</span>)</span></code></pre></div>
<p>먼저 NCA 분석을 해 봅니다.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="pk.html#cb4-1"></a>NonCompart<span class="op">::</span><span class="kw">sNCA</span>(dPK02[,<span class="st">&quot;TIME&quot;</span>], dPK02[,<span class="st">&quot;DV&quot;</span>], <span class="dt">dose=</span><span class="dv">100</span>, <span class="dt">doseUnit=</span><span class="st">&quot;ug&quot;</span>, <span class="dt">timeUnit=</span><span class="st">&quot;min&quot;</span>)</span></code></pre></div>
<pre><code>##            b0          CMAX         CMAXD          TMAX          TLAG 
##  1.557534e+00  2.000000e+00  2.000000e-02  4.000000e+01  1.000000e+01 
##          CLST         CLSTP          TLST        LAMZHL          LAMZ 
##  1.800000e-01  1.647689e-01  3.600000e+02  7.424929e+01  9.335405e-03 
##        LAMZLL        LAMZUL       LAMZNPT        CORRXY            R2 
##  9.000000e+01  3.600000e+02  7.000000e+00 -9.822141e-01  9.647446e-01 
##         R2ADJ        AUCLST        AUCALL        AUCIFO       AUCIFOD 
##  9.576935e-01  3.308750e+02  3.308750e+02  3.501564e+02  3.501564e+00 
##        AUCIFP       AUCIFPD        AUCPEO        AUCPEP       AUMCLST 
##  3.485249e+02  3.485249e+00  5.506520e+00  5.064170e+00  4.230750e+04 
##       AUMCIFO       AUMCIFP       AUMCPEO       AUMCPEP          VZFO 
##  5.131423e+04  5.055210e+04  1.755210e+01  1.630912e+01  3.059178e+01 
##          VZFP          CLFO          CLFP      MRTEVLST      MRTEVIFO 
##  3.073499e+01  2.855866e-01  2.869236e-01  1.278655e+02  1.465466e+02 
##      MRTEVIFP 
##  1.450459e+02 
## attr(,&quot;units&quot;)
##  [1] &quot;&quot;            &quot;ug/L&quot;        &quot;ug/L/ug&quot;     &quot;min&quot;         &quot;min&quot;        
##  [6] &quot;ug/L&quot;        &quot;ug/L&quot;        &quot;min&quot;         &quot;min&quot;         &quot;/min&quot;       
## [11] &quot;min&quot;         &quot;min&quot;         &quot;&quot;            &quot;&quot;            &quot;&quot;           
## [16] &quot;&quot;            &quot;min*ug/L&quot;    &quot;min*ug/L&quot;    &quot;min*ug/L&quot;    &quot;min*ug/L/ug&quot;
## [21] &quot;min*ug/L&quot;    &quot;min*ug/L/ug&quot; &quot;%&quot;           &quot;%&quot;           &quot;min2*ug/L&quot;  
## [26] &quot;min2*ug/L&quot;   &quot;min2*ug/L&quot;   &quot;%&quot;           &quot;%&quot;           &quot;L&quot;          
## [31] &quot;L&quot;           &quot;L/min&quot;       &quot;L/min&quot;       &quot;min&quot;         &quot;min&quot;        
## [36] &quot;min&quot;        
## attr(,&quot;UsedPoints&quot;)
## [1]  7  8  9 10 11 12 13</code></pre>
<div id="pk1" class="section level2">
<h2><span class="header-section-number">1.1</span> PK1</h2>
<p>경구 투여 일구획 분석, 지연시간이 없는 모형</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="pk.html#cb6-1"></a>DOSE =<span class="st"> </span><span class="dv">100</span></span>
<span id="cb6-2"><a href="pk.html#cb6-2"></a></span>
<span id="cb6-3"><a href="pk.html#cb6-3"></a>fPK02a =<span class="st"> </span><span class="cf">function</span>(THETA) <span class="co"># Prediction function</span></span>
<span id="cb6-4"><a href="pk.html#cb6-4"></a>{</span>
<span id="cb6-5"><a href="pk.html#cb6-5"></a>  Ka =<span class="st"> </span>THETA[<span class="dv">1</span>]</span>
<span id="cb6-6"><a href="pk.html#cb6-6"></a>  V  =<span class="st"> </span>THETA[<span class="dv">2</span>]</span>
<span id="cb6-7"><a href="pk.html#cb6-7"></a>  K  =<span class="st"> </span>THETA[<span class="dv">3</span>]</span>
<span id="cb6-8"><a href="pk.html#cb6-8"></a>  Cp =<span class="st"> </span>DOSE<span class="op">/</span>V<span class="op">*</span>Ka<span class="op">/</span>(Ka <span class="op">-</span><span class="st"> </span>K)<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>K<span class="op">*</span>TIME) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>Ka<span class="op">*</span>TIME)) <span class="co"># eq 2:1</span></span>
<span id="cb6-9"><a href="pk.html#cb6-9"></a>  <span class="kw">return</span>(Cp)</span>
<span id="cb6-10"><a href="pk.html#cb6-10"></a>}</span>
<span id="cb6-11"><a href="pk.html#cb6-11"></a>TIME =<span class="st"> </span>dPK02[,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb6-12"><a href="pk.html#cb6-12"></a>r1 =<span class="st"> </span><span class="kw">nlr</span>(fPK02a, dPK02, <span class="dt">pNames=</span><span class="kw">c</span>(<span class="st">&quot;ka&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;k&quot;</span>), <span class="dt">IE=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">30</span>, <span class="fl">0.05</span>)) ; r1</span></code></pre></div>
<pre><code>## $Est
##               ka         V            k   AddErrVar    AddErrSD
## PE   0.013202142 21.017659  0.013202008  0.08701446  0.29498213
## SE   0.005442004  8.623411  0.005441954  0.03412981  0.05785063
## RSE 41.220611647 41.029360 41.220651532 39.22314350 19.61157175
## 
## $Cov
##                      ka             V             k     AddErrVar
## ka         2.961540e-05  4.495113e-02 -2.716297e-05  7.006037e-10
## V          4.495113e-02  7.436322e+01 -4.543926e-02  1.609271e-06
## k         -2.716297e-05 -4.543926e-02  2.961486e-05 -1.099428e-09
## AddErrVar  7.006037e-10  1.609271e-06 -1.099428e-09  1.164844e-03
## 
## $run
## $run$m
## [1] 4
## 
## $run$n
## [1] 9
## 
## $run$run
## [1] 3
## 
## $run$p.value
## [1] 0.01818182
## 
## 
## $`Objective Function Value`
## [1] -18.74183
## 
## $`-2LL`
## [1] 5.150577
## 
## $AIC
## [1] 13.15058
## 
## $AICc
## [1] 18.15058
## 
## $BIC
## [1] 15.41037
## 
## $Convergence
## NULL
## 
## $Message
## [1] &quot;CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH&quot;
## 
## $Prediction
##  [1] 0.5504580 0.7729431 0.9647578 1.2681589 1.4817554 1.7068526 1.7229776
##  [8] 1.5460044 1.0502355 0.8245668 0.6341765 0.3590086 0.1951061
## 
## $Residual
##  [1] -0.55045799 -0.49294305 -0.41475779 -0.06815889  0.51824458
##  [6]  0.24314740  0.12702241  0.05399564 -0.19023546 -0.04456675
## [11] -0.03417646 -0.14900858 -0.01510607
## 
## $`Elapsed Time`
## Time difference of 0.01595688 secs</code></pre>
</div>
<div id="pk2" class="section level2">
<h2><span class="header-section-number">1.2</span> PK2</h2>
<p>경구 투여 일구획 분석, 지연시간이 있는 모형</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="pk.html#cb8-1"></a>fPK02b =<span class="st"> </span><span class="cf">function</span>(THETA) <span class="co"># Prediction function</span></span>
<span id="cb8-2"><a href="pk.html#cb8-2"></a>{</span>
<span id="cb8-3"><a href="pk.html#cb8-3"></a>  Ka   =<span class="st"> </span>THETA[<span class="dv">1</span>]</span>
<span id="cb8-4"><a href="pk.html#cb8-4"></a>  V    =<span class="st"> </span>THETA[<span class="dv">2</span>]</span>
<span id="cb8-5"><a href="pk.html#cb8-5"></a>  K    =<span class="st"> </span>THETA[<span class="dv">3</span>]</span>
<span id="cb8-6"><a href="pk.html#cb8-6"></a>  tlag =<span class="st"> </span>THETA[<span class="dv">4</span>]</span>
<span id="cb8-7"><a href="pk.html#cb8-7"></a></span>
<span id="cb8-8"><a href="pk.html#cb8-8"></a>  Cp  =<span class="st"> </span>DOSE<span class="op">/</span>V<span class="op">*</span>Ka<span class="op">/</span>(Ka <span class="op">-</span><span class="st"> </span>K)<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>K<span class="op">*</span>(TIME <span class="op">-</span><span class="st"> </span>tlag)) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>Ka<span class="op">*</span>(TIME <span class="op">-</span><span class="st"> </span>tlag))) <span class="co"># eq 2:2</span></span>
<span id="cb8-9"><a href="pk.html#cb8-9"></a>  <span class="kw">return</span>(Cp)</span>
<span id="cb8-10"><a href="pk.html#cb8-10"></a>}</span>
<span id="cb8-11"><a href="pk.html#cb8-11"></a>TIME =<span class="st"> </span>dPK02[,<span class="st">&quot;TIME&quot;</span>]</span>
<span id="cb8-12"><a href="pk.html#cb8-12"></a>r2 =<span class="st"> </span><span class="kw">nlr</span>(fPK02b, dPK02, <span class="dt">pNames=</span><span class="kw">c</span>(<span class="st">&quot;ka&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;tlag&quot;</span>), <span class="dt">IE=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">30</span>, <span class="fl">0.05</span>, <span class="dv">20</span>)) </span></code></pre></div>
</div>
<div id="pk3" class="section level2">
<h2><span class="header-section-number">1.3</span> PK3</h2>
<p>지연 시간이 있는 모형의 적합이 더 좋은 것을 알 수 있습니다. Cmax 부분을 주의깊게 살펴보세요.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="pk.html#cb9-1"></a><span class="co"># Figure 2.3, p 480</span></span>
<span id="cb9-2"><a href="pk.html#cb9-2"></a><span class="kw">plot</span>(dPK02[,<span class="st">&quot;TIME&quot;</span>], dPK02[,<span class="st">&quot;DV&quot;</span>], <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">400</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>), </span>
<span id="cb9-3"><a href="pk.html#cb9-3"></a>     <span class="dt">xlab=</span><span class="st">&quot;Time (min)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Concentration (ug/L)&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb9-4"><a href="pk.html#cb9-4"></a>TIME =<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">400</span></span>
<span id="cb9-5"><a href="pk.html#cb9-5"></a><span class="kw">lines</span>(TIME, <span class="kw">fPK02a</span>(r1<span class="op">$</span>Est[<span class="st">&quot;PE&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]), <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb9-6"><a href="pk.html#cb9-6"></a><span class="kw">lines</span>(TIME, <span class="kw">fPK02b</span>(r2<span class="op">$</span>Est[<span class="st">&quot;PE&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.svg" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/001-pharmacokinetics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
